<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>郑大一附院急救信息大屏公告</title>
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link href="Styles/site.css" rel="stylesheet" type="text/css" />
    <script src="../Scripts/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script src="../Scripts/u.js" type="text/javascript"></script>
    <script src="../Scripts/ace-template.min.js" type="text/javascript"></script>
</head>
<body>
	<script type="text/javascript">

        var _pageIndex = 1;
        var _weeks = new Array("星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六");

        function ShowDateInfo() {
            var time = new Date();

            $("#spanDate").html(time.format("yyyy年MM月dd日") + _weeks[time.getDay()]);

            $("#spanTime").html(time.format("hh:mm:ss"));
        }

        function LoadMissionData() {
                    //模拟数据
                    var responseText={"success":true,"result":{"limit":1,"page":6,"start":5,"sorters":[],"filters":[],"total":9,"pageCount":9,"results":[{"id":12121,"destinationAddress":"大石桥","contactPhone":"18788990909","contact":"钱书","x":40.633970,"y":122.505890,"missionGenerateTime":"2013年08月13日 09:11:38","acceptMissionTime":"2013年08月14日 08:48:35","startTime":"2013年08月13日 09:08:38","arrivedSceneTime":"2013年08月13日 09:35:40","arrivedPatientTime":"2013年08月13日 09:40:05","leftSceneTime":"2013年08月13日 09:59:35","status":"回院途中","type":"自出任务","completeStatus":"未完成","hospital":{"id":1,"status":"启用","createTime":"0001年01月01日 12:00:00"},"hospitalId":1,"vehicle":{"id":22,"code":"08-02","plateNumber":"豫A-30002","carPhone":"13814800002","status":"回院途中","hospital":{"id":1,"status":"启用","createTime":"0001年01月01日 12:00:00"},"hospitalId":1,"equipments":[],"missions":[],"createTime":"2013年05月11日 06:27:37","createBy":"admin","updateTime":"2013年05月15日 04:53:00","modifiedBy":"admin"},"doctor":{"id":11221,"name":"d21","trueName":"马伟","status":"任务中","createTime":"2013年08月13日 05:12:51","createBy":"admin","hospital":{"id":1,"status":"启用","createTime":"0001年01月01日 12:00:00"},"hospitalId":1,"userRoles":[]},"nurse":{"id":11217,"name":"n26","trueName":"李晓璐","status":"任务中","createTime":"2013年08月13日 05:05:35","createBy":"admin","hospital":{"id":1,"status":"启用","createTime":"0001年01月01日 12:00:00"},"hospitalId":1,"userRoles":[]},"driver":{"id":11233,"name":"sj24","trueName":"李顺","status":"任务中","createTime":"2013年08月13日 05:31:12","createBy":"admin","hospital":{"id":1,"status":"启用","createTime":"0001年01月01日 12:00:00"},"hospitalId":1,"userRoles":[]},"isCompleted":false,"patient":{"id":12931,"name":"吕斌","gender":"男性","age":{"value":68,"unit":"岁"},"nation":"汉族","state":"中国","status":"启用","createTime":"2013年08月14日 08:48:35","createBy":"d21","examinations":[]},"orders":[],"record":{"id":12121,"address":"大石桥丹尼斯正门","contactNumber":"18788990909","sceneType":"公共场所","reasonType":"疾病","conditionGrade":"中","coordinateDegree":"合作","diseaseType":"外伤","diseaseCategory":"外伤","sentLocationType":"本院","treatmentResult":"稳定","chiefComplaint":"突然晕厥并小便失禁20分钟","presentIllness":"患者于20分钟前五明显诱因突然晕厥，并小便失禁，商场保安人员发现后拨打120","diagnosis":"脑血管意外？","createTime":"2013年08月14日 08:48:35","createBy":"d21","status":"启用","isCerebralApoplexy":false},"inspection":{"id":12121,"isBloodGlucose":true,"examinationResult":"10.5mol/l","T":38.0,"pulse":73,"RR":19,"SBP":53,"DBP":96,"situation":"尚可","mind":"模糊","pupil":{"leftSize":2,"rightSize":2,"response":"存在"},"chest":"未见yi","heart":"心音低钝无力","abdomen":"平软","spine":"未见异常","neck":"面色苍白，大汗，颈软无抵抗","lungs":"双肺呼吸音清","status":"启用"},"treatments":[],"informedConsent":{"id":12121,"hospital":"郑大一附院","relationship":"陌生人","informedConsentItems":[],"status":"启用"},"emergencyMonitorDatas":[{"timePoint":"2013年08月16日 10:14:30","monitorId":4013,"HR":60.0,"PLUES":60.0,"RESP":20.0,"SPO2":98.0,"NBP_SYS":108.0,"NBP_DIA":70.0,"NBP_MAP":84.0}]}]}};
                    var mission = responseText.result.results[0];
                    var content = AceTemplate.format("content", { mission: mission });

                    $("#dvContent").html(content);

                    $("#spanPageInfo").html("第" + responseText.result.page + "页 共" + responseText.result.pageCount + "页");

                    if (_pageIndex < responseText.result.pageCount) {
                        _pageIndex += 1;
                    }
                    else {
                        _pageIndex = 1;
                    }
                
        }

        $(document).ready(function () {
            var resizeTimeout;
            $(window).resize(function(){
                clearTimeout(resizeTimeout);
                resizeTimeout=setTimeout(function(){
                     if($("body").height()<=$(window).height()){
                        $(".pgfooter").css("height",$(window).height()-$(".pgheader").height()-$(".pgbody").height());
                    }
                    else{
                        $(".pgfooter").css("height",53);
                    }
                },300);   
            });
            LoadMissionData();

            setInterval(ShowDateInfo, 1000);

            
            
        });
        
    </script>
    <!-- 头部 -->
    <div class="pgheader">
    	<div class="contain fix">
	    	<div class="pgheader__name fl">
	    		<div class="pgheader__namebox">
	    			<div class="pgheader__nameinner">郑大一附院急救信息大屏公告</div>
	    		</div>
	    	</div>
	    	<div class="pgheader__date"><span id="spanDate"></span></div>
	    	<div class="pgheader__time"> <span id="spanTime"></span></div>
    	</div>
    </div>

    <div class="pgbody">
        <div class="contain">
            <div class="pgbodybox">
                <div class="pgbodyinner">
                    <div class="pgbodymainbox" id="dvContent">
                        <script id="content" type="text/template">
                        <!-- 急救目前状态 -->
                        <div class="roadstate">
                            <div class="roadstate_beginicon"></div>
                            <div class="roadstate_endicon"></div>
                            <div class="roadstate_box">
                                <div class="roadstate_inner">
                                    <ul class="roadstate_steps fix">
                                        <li class="roadstate_step1">
                                            <div class="roadstate_state">
                                                <p class="roadstate_txt1">赶往现场</p>
                                            </div>
                                            <!-- 救护车
                                            <div class="roadstate_nowstate">
                                                <p class="roadstate_txt2"> </p>
                                                <p class="roadstate_txt3"></p>
                                            </div>
                                             -->
                                        </li>
                                        <li class="roadstate_step2">
                                            <div class="roadstate_state">
                                                <p class="roadstate_txt1">回去途中</p>
                                            </div>
                                            <!-- 救护车
                                            <div class="roadstate_nowstate">
                                                <p class="roadstate_txt2"> </p>
                                                <p class="roadstate_txt3"></p>
                                            </div>
                                             -->
                                        </li>
                                        <li class="roadstate_step3">
                                            <!--  
                                            <div class="roadstate_state">
                                                <p class="roadstate_txt1">到达现场（现场救治）</p>
                                            </div>
                                            -->
                                            <!-- 救护车-->
                                            <div class="roadstate_nowstate">
                                                <p class="roadstate_txt2">到达现场（现场救治） </p>
                                                <p class="roadstate_txt3">08-02车</p>
                                            </div>
                                        </li>
                                        <li class="roadstate_step4">
                                            <div class="roadstate_state">
                                                <p class="roadstate_txt1">到达医院</p>
                                            </div>
                                            <!-- 救护车
                                            <div class="roadstate_nowstate">
                                                <p class="roadstate_txt2"> </p>
                                                <p class="roadstate_txt3"></p>
                                            </div>
                                             -->
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- 数据表格-->
                        if(this["mission"].patient.examinations.length == 0) {
                            <div class="emergencydatas">
                        }
                        else {
                            <div class="emergencydatas emergencydatas--2column fix">
                        }
                            <div class="emergencydatas_table">
                                 <table id="tableContent1" cellpadding="0" cellspacing="0" class="table">
                                    <tr class="table__hd">
                                        <td colspan="3">
                                            #{mission.patient.name}/#{mission.patient.gender.replace("性", "")}/#{mission.patient.age.value + mission.patient.age.unit}/ <span style="color: #ffff00;margin-right:10px;">#{mission.record.conditionGrade}</span>

                                            var conditionGrade = this["mission"].record.conditionGrade;
                                            var count = conditionGrade == "轻" ? 1 : conditionGrade == "中" ? 2 : conditionGrade == "重" ? 3 : 0;

                                            for(var i = 0; i < count; i++) {
                                                <img class="savinglevel-icon" src="images/savingstar.png" style="vertical-align: middle;" />
                                            }
                                        </td>
                                    </tr>
                                    <tr>
                                        if(this["mission"].patient.examinations.length == 0) {
                                            <td style="width: 10%;">
                                        }
                                        else {
                                            <td style="width: 20.2%;">
                                        }
                                            事发地
                                        </td>
                                        if(this["mission"].patient.examinations.length == 0) {
                                            <td>
                                                #{mission.destinationAddress}
                                            </td>
                                            <td rowspan="8" class="table_rowstd" style="background-color: Black; padding-left: 10px; text-indent: 0px; width: 15%;">
                                                <span style="color: #ffff00;">RR：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].RESP}</span></span>
                                                <br />
                                                <span style="color: #33cc00;">HR：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].HR}</span></span>
                                                <br />
                                                <span style="color: #f93b08;">BP：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].NBP_SYS + "/" + mission.emergencyMonitorDatas[0].NBP_DIA}</span></span>
                                                <br />
                                                <span style="color: #00cccc;">SP0<sub>2</sub>：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].SPO2}</span></span>
                                            </td>
                                        }
                                        else {
                                            <td colspan="2">
                                                #{mission.destinationAddress}
                                            </td>
                                        }
                                    </tr>
                                    <tr>
                                        <td>
                                            急救原因
                                        </td>
                                        if(this["mission"].patient.examinations.length == 0) {
                                            <td>
                                                #{mission.record.reasonType}
                                            </td>
                                        }
                                        else {
                                            <td colspan="2">
                                                #{mission.record.reasonType}
                                            </td>
                                        }
                                    </tr>
                                    <tr>
                                        <td>
                                            脑卒中时间
                                        </td>
                                        if(this["mission"].patient.examinations.length == 0) {
                                            <td>
                                                脑卒中30分钟
                                            </td>
                                        }
                                        else {
                                            <td colspan="2">
                                                脑卒中30分钟
                                            </td>
                                        }
                                    </tr>
                                    <tr>
                                        <td>
                                            分诊结果
                                        </td>
                                        if(this["mission"].patient.examinations.length == 0) {
                                            <td style="color: #f93b08;">
                                                <b>1级 抢救室</b>
                                            </td>
                                        }
                                        else {
                                            <td colspan="2" style="color: #f93b08;">
                                                <b>1级 抢救室</b>                                       
                                            </td>
                                        }
                                    </tr>
                                    <tr>
                                        <td>
                                            司机
                                        </td>
                                        <td>
                                            #{mission.driver.name}
                                        </td>
                                        if(this["mission"].patient.examinations.length > 0) {
                                            <td rowspan="4" style="background-color: Black; line-height: 35px; padding-left: 10px; text-indent: 0px; width: 30%;">
                                                <span style="color: #ffff00;">RR：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].RESP}</span></span>
                                                <br />
                                                <span style="color: #33cc00;">HR：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].HR}</span></span>
                                                <br />
                                                <span style="color: #f93b08;">BP：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].NBP_SYS + "/" + mission.emergencyMonitorDatas[0].NBP_DIA}</span></span>
                                                <br />
                                                <span style="color: #00cccc;">SP0<sub>2</sub>：<span style="font-size: 18pt;">#{mission.emergencyMonitorDatas[0].SPO2}</span></span>
                                            </td>
                                        }
                                    </tr>
                                    <tr>
                                        <td>
                                            司机电话
                                        </td>
                                        <td>
                                            #{mission.vehicle.carPhone}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            医生
                                        </td>
                                        <td>
                                            #{mission.doctor.name}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            护士
                                        </td>
                                        <td>
                                            #{mission.nurse.name}
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <div class="emergencydatas_table emergencydatas_table--sectable">
                                <table id="tableContent2" cellpadding="0" cellspacing="0" class="table" style="text-indent: 0px;">
                                <tr class="table__hd">
                                    <td align="center" style="width: 50%;">
                                        检验（检查）项目
                                    </td>
                                    <td align="center" style="width: 20%;">
                                        状态
                                    </td>
                                    <td align="center" style="width: 30%;">
                                        部位/样本
                                    </td>
                                </tr>
                                for(var i = 0; i < this["mission"].patient.examinations.length; i++) {
                                    var examination = this["mission"].patient.examinations[i];

                                    <tr>
                                        <td style="text-indent: 15px;" nowrap="nowrap">
                                            #{examination.name}
                                        </td>
                                        <td align="center">
                                            #{examination.status}
                                        </td>
                                        <td align="center">
                                            #{examination.bodyPart ? examination.bodyPart : examination.specimen ? examination.specimen : ""}
                                        </td>
                                    </tr>
                                }

                                for(var i = 0; i < 8 - this["mission"].patient.examinations.length; i++) {
                                    <tr>
                                        <td style="text-indent: 15px;" nowrap="nowrap">
                                           &nbsp;
                                        </td>
                                        <td align="center">
                                            
                                        </td>
                                        <td align="center">
                        
                                        </td>
                                    </tr>
                                }
                            </table>
                            </div>

                        </div>
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 底部页码 -->
    <div class="pgfooter">
        <div class="contain">
            <p class="paginations"><span id="spanPageInfo">第1页  共3页</span> </p>
        </div>
    </div>
</body>
</html>
